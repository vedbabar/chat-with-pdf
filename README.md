# AI-Powered Document Chat\n\nThis repository contains the code for an AI-powered document chat application. Users can upload documents, and the application will process them to enable semantic search and question answering.\n\n## Tech Stack\n\n*   **Frontend:** Next.js, Tailwind CSS, Clerk\n*   **Backend:** Node.js, Express.js, Prisma\n*   **Database:** PostgreSQL\n*   **Vector Database:** Qdrant\n*   **LLM:** Google Gemini\n*   **Queue:** BullMQ\n*   **Cloud Storage:** Cloudinary\n\n## Project Structure\n\n```\n├── client/          # Next.js frontend application\n├── server/          # Node.js backend application\n└── README.md        # This file\n```\n\n**Key Files/Directories:**\n\n*   `client/`: Contains the Next.js frontend application.\n    *   `client/lib/utils.ts`: Utility functions for CSS class name manipulation.\n    *   `client/middleware.ts`: Clerk authentication middleware.\n    *   `client/next.config.ts`: Next.js configuration file.\n*   `server/`: Contains the Node.js backend application.\n    *   `server/index.js`: Main entry point for the backend server.\n    *   `server/worker.js`: Background worker for file processing.\n    *   `server/prisma/`: Prisma related files.\n        *   `server/prisma/schema.prisma`: Prisma schema definition.\n        *   `server/prisma/migrations/`: Database migration files.\n\n## Key Components/Modules\n\n*   **`client/lib/utils.ts`:** Provides the `cn` function for merging and deduplicating CSS class names, simplifying Tailwind CSS management.\n*   **`client/middleware.ts`:** Enforces authentication for protected routes (`/dashboard`, `/chat`, `/upload`) using Clerk.\n*   **`server/index.js`:** Handles file uploads, creates vector embeddings, and stores them in Qdrant.  Manages API endpoints and queues file processing tasks.\n*   **`server/worker.js`:** Processes uploaded PDF files, splits them into chunks, generates embeddings using Google Gemini, and stores them in Qdrant.\n*   **Prisma Schema (`server/prisma/schema.prisma`):** Defines the database schema with `Chat`, `Message`, and `File` models.\n*   **Database Migrations (`server/prisma/migrations/`):** SQL scripts to evolve the database schema.\n\n## Setup\n\n1.  **Clone the repository:**\n\n    ```bash\n    git clone <repository_url>\n    cd <repository_directory>\n    ```\n\n2.  **Install dependencies:**\n\n    ```bash\n    cd client\n    npm install # or yarn install or pnpm install\n    cd ../server\n    npm install # or yarn install or pnpm install\n    ```\n\n3.  **Set up the database:**\n\n    *   Ensure you have PostgreSQL installed and running.\n    *   Create a `.env` file in the `server/` directory and configure the `DATABASE_URL` environment variable.\n    *   Run the Prisma migrations:\n\n        ```bash\n        cd server\n        npx prisma migrate dev --name init\n        ```\n\n## Usage\n\n1.  **Start the development servers:**\n\n    ```bash\n    # In separate terminals\n    cd client\n    npm run dev # or yarn dev or pnpm dev\n\n    cd ../server\n    node index.js # or npm start\n    node worker.js # start the worker\n    ```\n\n2.  **Access the application:**\n\n    Open your browser and navigate to the address where the client application is running (usually `http://localhost:3000`).\n\n## Configuration\n\nCreate `.env` files in both `client/` and `server/` directories.\n\n**Server-side `.env` variables:**\n\n| NAME                  | Purpose                               | Required | Default |\n| --------------------- | ------------------------------------- | -------- | ------- |\n| `DATABASE_URL`        | PostgreSQL database connection URL    | Yes      |         |\n| `CLERK_SECRET_KEY`    | Clerk secret key                      | Yes      |         |\n| `GOOGLE_API_KEY`      | Google Gemini API key                 | Yes      |         |\n| `QDRANT_URL`          | Qdrant instance URL                   | Yes      |         |\n| `QDRANT_API_KEY`      | Qdrant API key                        | Yes      |         |\n| `CLOUDINARY_CLOUD_NAME` | Cloudinary cloud name               | Yes      |         |\n| `CLOUDINARY_API_KEY`  | Cloudinary API key                    | Yes      |         |\n| `CLOUDINARY_API_SECRET`| Cloudinary API secret                 | Yes      |         |\n\n**Client-side `.env` variables:**\n\n| NAME                  | Purpose                               | Required | Default |\n| --------------------- | ------------------------------------- | -------- | ------- |\n| `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | Clerk publishable key                      | Yes      |         |\n\n## Data Model\n\n*   **Chat:**\n    *   `id` (UUID, Primary Key)\n    *   `name` (String)\n    *   `createdAt` (DateTime)\n    *   `updatedAt` (DateTime)\n    *   `userId` (String)\n*   **Message:**\n    *   `id` (UUID, Primary Key)\n    *   `chatId` (UUID, Foreign Key to Chat)\n    *   `role` (String)\n    *   `content` (String)\n    *   `document` (JSON)\n    *   `createdAt` (DateTime)\n*   **File:**\n    *   `id` (UUID, Primary Key)\n    *   `filename` (String)\n    *   `path` (String)\n    *   `createdAt` (DateTime)\n    *   `chatId` (UUID, Foreign Key to Chat)\n    *   `status` (String, Default: \"PENDING\")\n    *   `publicId` (String, Default: \"MIGRATED_NO_ID\")\n    *   `updatedAt` (DateTime)\n\n## Deployment\n\n*   **Frontend:** Deploy the `client/` directory to a Next.js hosting platform like Vercel or Netlify.\n*   **Backend:** Deploy the `server/` directory to a Node.js hosting platform like Render, Heroku, or AWS.\n*   **Database:** Host the PostgreSQL database on a cloud provider like AWS RDS, Google Cloud SQL, or Azure Database for PostgreSQL.\n*   **Vector Database:** Host the Qdrant vector database on a cloud provider or self-host it.\n*   **Queue:** Configure BullMQ to use a Redis instance for queue management.\n*   **Cloud Storage:** Configure Cloudinary to store uploaded files.\n\n## Roadmap/Limitations\n\n*   Implement comprehensive testing.\n*   Add more robust error handling and logging.\n*   Improve the user interface and user experience.\n*   Support more document types.\n*   Implement user roles and permissions.\n*   Explore other LLMs and embedding models.
