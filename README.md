# AI Chatbot with Document Upload and Processing\n\n## Overview\n\nThis project is an AI chatbot that allows users to upload PDF documents, process them into vector embeddings, and then engage in conversations with the chatbot, leveraging the content of the uploaded documents for context. The system utilizes a variety of technologies for different aspects of the application, including file handling, vector storage, database management, and queue processing.\n\n## Tech Stack\n\n*   **Frontend:**\n    *   Next.js\n    *   Tailwind CSS\n    *   Clerk (Authentication)\n    *   `clsx`, `tailwind-merge` (CSS Class Management)\n*   **Backend:**\n    *   Node.js\n    *   Express.js\n    *   Prisma (ORM)\n    *   PostgreSQL\n    *   Google Generative AI (Embeddings)\n    *   Qdrant (Vector Database)\n    *   Upstash Redis / Redis\n    *   BullMQ (Queue Management)\n    *   Cloudinary (File Storage)\n    *   Multer (File Upload)\n    *   Langchain\n    *   Axios\n*   **Other:**\n    *   Docker (for containerization)\n\n## Installation\n\n1.  **Clone the repository:**\n\n    ```bash\n    git clone <repository_url>\n    cd <project_directory>\n    ```\n\n2.  **Install dependencies:**\n\n    ```bash\n    npm install # or yarn install or pnpm install\n    ```\n\n3.  **Set up environment variables:**\n\n    Create a `.env` file in the root directory and populate it with the necessary environment variables.  These include:\n\n    *   `DATABASE_URL`: PostgreSQL connection string.\n    *   `GOOGLE_API_KEY`: Google Generative AI API key.\n    *   `QDRANT_URL`: Qdrant vector database URL.\n    *   `QDRANT_API_KEY`: Qdrant API key (if applicable).\n    *   `UPSTASH_REDIS_REST_URL` or `REDIS_URL`: Upstash Redis or Redis connection string.\n    *   `UPSTASH_REDIS_REST_TOKEN`: Upstash Redis token (if applicable).\n    *   `CLERK_SECRET_KEY`: Clerk secret key.\n    *   `CLERK_PUBLISHABLE_KEY`: Clerk publishable key.\n    *   `CLERK_SIGN_IN_URL`: Clerk sign in URL.\n    *   `CLERK_SIGN_UP_URL`: Clerk sign up URL.\n    *   `CLERK_AFTER_SIGN_IN_URL`: Clerk after sign in URL.\n    *   `CLERK_AFTER_SIGN_UP_URL`: Clerk after sign up URL.\n    *   `CLOUDINARY_CLOUD_NAME`: Cloudinary cloud name.\n    *   `CLOUDINARY_API_KEY`: Cloudinary API key.\n    *   `CLOUDINARY_API_SECRET`: Cloudinary API secret.\n\n4.  **Set up the database:**\n\n    ```bash\n    npx prisma migrate dev --name init\n    ```\n\n    Apply subsequent migrations:\n\n    ```bash\n    npx prisma migrate dev --name add_file_status\n    npx prisma migrate dev --name add_user_auth\n    npx prisma migrate dev --name add_cloudinary_public_id\n    ```\n\n    Generate the Prisma client:\n\n    ```bash\n    npx prisma generate\n    ```\n\n5.  **Start the development servers:**\n\n    ```bash\n    npm run dev # or yarn dev or pnpm dev\n    ```\n\n    This will typically start the Next.js frontend and the Express.js backend.  You may need to start the worker process separately:\n\n    ```bash\n    node server/worker.js\n    ```\n\n## Usage\n\n1.  **Access the application:**\n\n    Open your web browser and navigate to the address where the Next.js frontend is running (usually `http://localhost:3000`).\n\n2.  **Authenticate:**\n\n    Use the Clerk authentication system to sign in or sign up.\n\n3.  **Upload a PDF document:**\n\n    Navigate to the upload section of the application and upload a PDF file.\n\n4.  **Chat with the AI:**\n\n    Once the document is processed (the status will change from PENDING), you can start chatting with the AI. The AI will use the content of the uploaded document to provide context-aware responses.\n\n## File Structure and Key Components\n\n*   **`client/`:** Contains the Next.js frontend application.\n    *   `client/lib/utils.ts`: Utility functions for CSS class management.\n    *   `client/middleware.ts`: Authentication middleware for route protection.\n    *   `client/next.config.ts`: Next.js configuration file.\n*   **`server/`:** Contains the backend server and worker processes.\n    *   `server/index.js`: Express.js server for handling API requests.\n    *   `server/worker.js`: BullMQ worker for processing file uploads.\n    *   `server/prisma/`: Prisma-related files.\n        *   `server/prisma/schema.prisma`: Prisma schema definition.\n        *   `server/prisma/migrations/`: Database migration files.\n\n## Notes\n\n*   The `next.config.ts` file currently disables ESLint and TypeScript checks during builds. This is likely a temporary measure and should be addressed by resolving the underlying issues.\n*   The migration `20250907084528_add_user_auth/migration.sql` requires the `Chat` table to be empty before applying the migration.\n*   The worker process requires a running Redis instance (either Upstash or a standard Redis instance) for queue management.\n*   The worker process starts a dummy HTTP server to keep Render happy.  This may need to be adjusted depending on your deployment environment.
